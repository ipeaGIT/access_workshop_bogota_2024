{
  "hash": "190a5ed7a0b85c928be3416e36364f48",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Equity measures\"\nfrom: markdown+emoji\n---\n\n\n\n\nA central question in transportation research and practice involves assessing how the accessibility benefits of transportation systems and projects are distributed across different socioeconomic and demographic groups. Transportation equity concerns are fundamentally related to two types of issues: (1) accessibility inequality and (2) accessibility poverty. **In this section you will learn how to use the `{accessibility}` package to calculate different indicators of accessibility inequality and poverty.**\n<img align=\"right\" src=\"/images/accessibility_logo.png?raw=true\" alt=\"logo\" width=\"140\">\n\nIn a recent paper, we discussed the advantages and disadvantages of various inequality and poverty metrics most commonly used in the transport literature [@karner2024advances] - ungated PDF [here](https://www.urbandemographics.org/publication/2024_transp_measuring_transportation_equity/). The slides below give a *very* short summary of some ideas discussed in the paper. Just enough to follow this workshop section. Nonetheless, I would strongly recommend reading the whole paper.\n\n \n<!-- Slides -->\n<p><embed src=\"slides/3.3_equity_metrics.pdf\" style=\"width:100.0%;height:100vh;\" /></p>\n\n\nIn this section, we'll be using a couple sample data sets for the city of Belo Horizonte (Brazil), which come with the `{accessibility}` package. In the code chunk below, we read the travel time matrix and land use data, and calculate the average number of jobs accessible in 30 by public transport.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(accessibility)\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# path to data\ndata_dir <- system.file(\"extdata\", package = \"accessibility\")\n\n# read travel matrix and land use data\nttm <- readRDS(file.path(data_dir, \"travel_matrix.rds\"))\nlud <- readRDS(file.path(data_dir, \"land_use_data.rds\"))\n\n# calculate threshold-based cumulative access\naccess_df <- cumulative_cutoff(\n  travel_matrix = ttm,\n  land_use_data = lud,\n  opportunity = \"jobs\",\n  travel_cost = \"travel_time\",\n  cutoff = 30\n  )\n\nhead(access_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                id  jobs\n            <char> <int>\n1: 89a881a5a2bffff 14561\n2: 89a881a5a2fffff 29452\n3: 89a881a5a67ffff 16647\n4: 89a881a5a6bffff 10700\n5: 89a881a5a6fffff  6669\n6: 89a881a5b03ffff 37029\n```\n\n\n:::\n:::\n\n\n\n\n:mag_right: Time for a quick visual inspection! We can merge our accessibility results with the land use/population data, and visualize how employment accessibility is distributed across different income groups.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# merge acces and land use data\ndf <- access_df |>\n      rename(jobs_access = jobs) |>\n      left_join(lud, by='id')\n\n# remove spatial units with no population\ndf <- filter(df, population > 0)\n\n# box plot\nggplot(data = df) +\n  geom_boxplot(show.legend = FALSE,\n               aes(x = income_decile, \n                   y = jobs_access / 1000, \n                   weight = population, \n                   color = income_decile)) +\n  scale_colour_brewer(palette = 'RdBu') + \n  labs(subtitle = 'Number of jobs accessible in 30 minutes by public transport',\n       x = 'Income decile', y = 'Jobs (in thousands)') +\n  scale_x_discrete(labels = c(\"D1\\npoorest\", \n                              paste0(\"D\", 2:9), \n                              \"D10\\nwealthiest\")) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](3.3_equity_measures_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n\nThe box plot shows a very uneven distribution of access to job opportunities. Now let's check what we can learn about accessibility inequality and poverty in this region with a few examples.\n\n::: {.callout-tip appearance=\"simple\"}\nA detailed explanation of all inequality and poverty measures covered in `{accessibility}` are available in the [package documentation](https://ipeagit.github.io/accessibility/articles/inequality_and_poverty.html).\n:::\n\n# Inequality measures\n\n## Palma ratio\n\nThe Palma ratio is calculated as the average access of the richest 10% divided by the average access of the poorest 40%. Palma Ratio values higher than 1 indicate that the wealthiest population has higher accessibility levels than the poorest, whereas values lower than 1 indicate the opposite situation.\n\nIn the example here, we see that the wealthiest population can access on average 3.8 times more jobs than the poor population.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npalma <- palma_ratio(\n  accessibility_data = access_df,\n  sociodemographic_data = lud,\n  opportunity = \"jobs\",\n  population = \"population\",\n  income = \"income_per_capita\"\n  )\n\npalma\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   palma_ratio\n         <num>\n1:    3.800465\n```\n\n\n:::\n:::\n\n\n\n## Concentration index\n\nThe concentration index (CI) estimates the extent to which accessibility inequalities are systematically associated with individualsâ€™ socioeconomic levels. CI values can theoretically vary between -1 and 1 (when all accessibility is concentrated in the most or in the least disadvantaged person, respectively). Negative values indicate that inequalities favor the poor, while positive values indicate a pro-rich bias.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nci <- accessibility::concentration_index(\n  accessibility_data = access_df,\n  sociodemographic_data = lud,\n  opportunity = \"jobs\",\n  population = \"population\",\n  income = \"income_per_capita\",\n  type = \"corrected\"\n  )\n\nci\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   concentration_index\n                 <num>\n1:           0.3346494\n```\n\n\n:::\n:::\n\n\n\n## ~~Gini index~~\n\nYou probably shouldn't use the Gini index to measure accessibility inequality [see @karner2024advances].\n\n# Accessibility poverty\n\n## Foster-Greer-Thorbecke (FGT) poverty measures \n\nThe `fgt_poverty()` function calculates the FGT metrics, a family of poverty measures originally proposed by @foster1984class, and which that can be used to capture the extent and severity of poverty within an accessibility distribution. The FGT family is composed of three measures:\n\n- FGT0: it captures the extent of poverty as a simple headcount - i.e. the proportion of people below the poverty line;\n- FGT1: also know as the \"poverty gap index\", it captures the severity of poverty as the average percentage distance between the poverty line and the accessibility of individuals below the poverty line;\n- FGT2: it simultaneously captures the extent and the severity of poverty by calculating the number of people below the poverty line weighted by the size of the accessibility shortfall relative to the poverty line.\n\nThis function includes an additional `poverty_line` parameter, used to define\nthe poverty line below which individuals are considered to be in accessibility\npoverty. For the sake of this exercise, we'll consider the lowest 25th percentile of access as our poverty line, which in this example is approximately 23 thousand jobs.\n\n::: {.callout-important appearance=\"simple\"}\nQuick reminder that the definition of an accessibility poverty line is ultimately a moral and political decision and not simply an empirical or technical question [@pereira2017distributive; @lucas2019measuring].\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# get the 25th percentile of access\nquant25 <- quantile(access_df$jobs, .25)\n\npoverty <- fgt_poverty(\n  accessibility_data =  access_df,\n  sociodemographic_data = lud,\n  opportunity = \"jobs\",\n  population = \"population\",\n  poverty_line = quant25\n  )\n\npoverty\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        FGT0       FGT1       FGT2\n       <num>      <num>      <num>\n1: 0.1478675 0.04948043 0.02862334\n```\n\n\n:::\n:::\n\n\n\n\nQuick interpretation:\n\n- FGT0: 14.8% of the population are in accessibility poverty\n- FGT1: the accessibility of those living in accessibility poverty is on average 5% lower than the poverty line\n- FGT2: it has no clear interpretation, but one could say that the overall poverty level/intensity is 2.8%.\n\n",
    "supporting": [
      "3.3_equity_measures_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}